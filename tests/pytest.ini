[pytest]
# Pytest configuration for OHLCV RAG System

# Test discovery patterns - co-located tests use *_test.py pattern
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# Test paths - now co-located with source
testpaths = src tests

# Markers for different test types
markers =
    # Test categories
    unit: Unit tests with no external dependencies
    integration: Integration tests requiring services
    embedded: Integration tests using embedded/local modes
    e2e: End-to-end tests
    slow: Tests that take more than 5 seconds
    
    # Dependency markers
    mock: Tests using only mocks (no real dependencies)
    real_deps: Tests requiring real external dependencies
    docker: Tests requiring Docker containers
    
    # Service-specific markers
    chromadb: Tests requiring ChromaDB
    weaviate: Tests requiring Weaviate
    qdrant: Tests requiring Qdrant
    milvus: Tests requiring Milvus
    
    # API markers
    requires_api_key: Tests requiring API keys
    openai: Tests requiring OpenAI API
    yahoo_finance: Tests using Yahoo Finance API
    alpha_vantage: Tests requiring Alpha Vantage API
    api: Tests that make external API calls
    
    # Performance markers
    benchmark: Performance benchmark tests
    stress: Stress tests with high load
    
    # Async markers
    asyncio: Tests using asyncio

# Coverage settings
addopts = 
    --strict-markers
    --tb=short
    -ra
    --disable-warnings

# Ignore warnings
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning

# Timeout for tests (in seconds)
timeout = 300

# Asyncio settings
asyncio_mode = auto